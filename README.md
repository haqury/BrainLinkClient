# BrainLink Client - Python Edition

Python порт приложения BrainLinkConnect для управления компьютером с помощью EEG (электроэнцефалография) и гироскопа от устройства BrainLink.

## Описание

BrainLink Client - это приложение для подключения к устройству BrainLink через Bluetooth и использования данных мозговой активности (EEG) и движений головы (гироскоп) для управления курсором мыши.

## Возможности

### Основные функции
- **Подключение по Bluetooth** к устройству BrainLink
- **Чтение данных EEG**: Attention, Meditation, Delta, Theta, Alpha, Beta, Gamma волны
- **Данные гироскопа**: отслеживание движений головы (вверх/вниз/влево/вправо)
- **Управление мышью**: перемещение курсора на основе EEG паттернов
- **Запись и воспроизведение**: сохранение истории паттернов для обучения

### Дополнительные возможности
- Калибровка гироскопа для точного отслеживания
- Конфигурируемая чувствительность распознавания паттернов
- Многоуровневая система распознавания событий
- Сохранение/загрузка конфигураций и истории в JSON

## Установка

### Требования
- Python 3.8 или выше
- Windows 10/11 (для полной функциональности)

### Шаги установки

1. Клонируйте репозиторий или скопируйте файлы проекта

2. Создайте виртуальное окружение:
```bash
python -m venv venv
```

3. Активируйте виртуальное окружение:
```bash
# Windows
venv\Scripts\activate

# Linux/Mac
source venv/bin/activate
```

4. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Использование

### Запуск приложения

```bash
python main.py
```

### Основной рабочий процесс

1. **Подключение к устройству**
   - Нажмите кнопку "Start & Connect"
   - Выберите устройство BrainLink из списка
   - Нажмите "Connect"

2. **Режим обучения** (Training Mode)
   - Выберите направление (Move Left/Right/Up/Down/Stop)
   - Удерживайте клавишу со стрелкой на клавиатуре
   - Сконцентрируйтесь на действии
   - Данные автоматически сохранятся в историю

3. **Режим автоматического управления**
   - Включите "Auto Use (Direct Control)"
   - Включите "Use Key Control"
   - Приложение будет двигать курсор на основе распознанных паттернов

4. **Конфигурация**
   - Нажмите "Config Fault" для настройки чувствительности
   - Установите допуски для каждого параметра EEG
   - Сохраните конфигурацию в файл

5. **Управление историей**
   - "Save to File" - сохранить историю обучения
   - "Load from File" - загрузить ранее сохраненную историю
   - "Clear" - очистить текущую историю

### Использование гироскопа

1. Откройте окно "Gyro"
2. Нажмите "Calibrate" для установки центрального положения
3. Включите "Use Gyro for Control"
4. Двигайте головой для управления курсором

## Структура проекта

```
BrainLinkClient/
│
├── models/                  # Модели данных
│   ├── eeg_models.py       # EEG данные и конфигурация
│   ├── gyro_models.py      # Данные гироскопа
│   └── system_models.py    # Системная информация
│
├── services/               # Сервисные компоненты
│   ├── bluetooth_service.py    # Bluetooth подключение
│   ├── history_service.py      # Управление историей
│   ├── head_tracker_service.py # Отслеживание движений головы
│   ├── mouse_service.py        # Управление мышью
│   └── system_service.py       # Системные функции
│
├── ui/                     # Пользовательский интерфейс
│   ├── main_window.py      # Главное окно
│   ├── connect_form.py     # Окно подключения
│   ├── eeg_data_form.py    # Отображение EEG данных
│   ├── gyro_form.py        # Окно гироскопа
│   └── config_form.py      # Конфигурация
│
├── main.py                 # Точка входа в приложение
├── requirements.txt        # Зависимости Python
└── README.md              # Этот файл
```

## Технологии

- **PyQt5** - графический интерфейс
- **bleak** - Bluetooth Low Energy подключение
- **pyautogui** - управление мышью
- **pynput** - перехват клавиатуры
- **numpy** - математические операции

## Отличия от C# версии

### Улучшения
- Кроссплатформенность (Windows, Linux, macOS)
- Более простая установка (pip install)
- Асинхронная работа с Bluetooth (bleak)
- Современный Python код с type hints

### Ограничения
- Требуется настройка протокола BrainLink SDK
- Bluetooth подключение может отличаться в зависимости от ОС

## Конфигурационные файлы

### История (history.json)
```json
[
  {
    "attention": 75,
    "meditation": 60,
    "delta": 120000,
    "theta": 85000,
    "low_alpha": 45000,
    "high_alpha": 35000,
    "low_beta": 25000,
    "high_beta": 20000,
    "low_gamma": 15000,
    "high_gamma": 10000,
    "event_name": "ml"
  }
]
```

### Конфигурация (config.json)
```json
{
  "attention": 10,
  "meditation": 10,
  "delta": 50000,
  "theta": 50000,
  "low_alpha": 20000,
  "high_alpha": 20000,
  "low_beta": 15000,
  "high_beta": 15000,
  "low_gamma": 10000,
  "high_gamma": 10000
}
```

## Решение проблем

### Bluetooth не находит устройства
- Убедитесь, что Bluetooth включен
- Проверьте, что BrainLink включен и заряжен
- Попробуйте перезапустить приложение

### Курсор двигается слишком быстро/медленно
- Настройте параметры в Config Fault
- Увеличьте допуски для более плавного управления
- Уменьшите допуски для более точного управления

### Паттерны не распознаются
- Убедитесь, что записано достаточно данных в истории
- Попробуйте увеличить multi_count
- Проверьте настройки чувствительности

## Разработка

### Добавление новых функций

1. Модели данных → `models/`
2. Бизнес-логика → `services/`
3. UI компоненты → `ui/`

### Расширение протокола BrainLink

Для работы с реальным устройством BrainLink необходимо реализовать парсинг протокола в `services/bluetooth_service.py`:

```python
def _notification_handler(self, sender, data: bytearray):
    # Парсинг данных BrainLink
    # Вызов соответствующих callbacks
    pass
```

## Лицензия

Порт оригинального проекта BrainLinkConnect.

## Авторы

- Оригинальная версия (C#): BrainLinkConnect
- Python порт: 2026

## Поддержка

Для вопросов и предложений создавайте Issues в репозитории проекта.
